local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local player = Players.LocalPlayer
local savedPosition = nil

-- 防止重复生成
if player:FindFirstChild("PlayerGui"):FindFirstChild("TeleportFloating") then
    player.PlayerGui.TeleportFloating:Destroy()
end

-- 创建ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TeleportFloating"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- 创建悬浮窗
local floating = Instance.new("Frame")
floating.Size = UDim2.new(0, 180, 0, 40)
floating.Position = UDim2.new(0.5, -90, 0.5, -20)
floating.BackgroundColor3 = Color3.new(0,0,0)
floating.BorderSizePixel = 0
floating.Parent = screenGui
floating.Active = true
floating.Draggable = true

-- 保存按钮
local saveBtn = Instance.new("TextButton")
saveBtn.Size = UDim2.new(0, 60, 1, 0)
saveBtn.Position = UDim2.new(0, 0, 0, 0)
saveBtn.Text = "保存"
saveBtn.BackgroundColor3 = Color3.new(0.2,0.2,0.2)
saveBtn.TextColor3 = Color3.new(1,1,1)
saveBtn.Parent = floating

saveBtn.MouseButton1Click:Connect(function()
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        savedPosition = player.Character.HumanoidRootPart.Position
        StarterGui:SetCore("SendNotification", {
            Title = "您保存的坐标",
            Text = "X:"..math.floor(savedPosition.X).."  Y:"..math.floor(savedPosition.Y).."  Z:"..math.floor(savedPosition.Z),
            Duration = 2.5
        })
    end
end)

-- 中间竖线
local divider = Instance.new("Frame")
divider.Size = UDim2.new(0, 2, 1, -10)
divider.Position = UDim2.new(0, 90, 0, 5)
divider.BackgroundColor3 = Color3.new(1,1,1)
divider.Parent = floating

-- 传送按钮
local tpBtn = Instance.new("TextButton")
tpBtn.Size = UDim2.new(0, 60, 1, 0)
tpBtn.Position = UDim2.new(0, 120, 0, 0)
tpBtn.Text = "传送"
tpBtn.BackgroundColor3 = Color3.new(0.2,0.2,0.2)
tpBtn.TextColor3 = Color3.new(1,1,1)
tpBtn.Parent = floating

tpBtn.MouseButton1Click:Connect(function()
    if savedPosition and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        player.Character.HumanoidRootPart.CFrame = CFrame.new(savedPosition)
    end
end)
